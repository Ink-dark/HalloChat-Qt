## JWT令牌安全
- 算法：HMAC-SHA256 (HS256)
- 密钥存储：开发环境硬编码，生产环境使用安全存储
- 有效期：1小时 + 刷新令牌机制
- 签名验证：严格校验头部+载荷签名

## 安全措施说明
1. **密钥管理**：生产环境通过安全存储加载密钥，避免硬编码风险
2. **令牌生命周期**：短期有效（1小时）减少被盗用风险，配合刷新机制提升用户体验
3. **签名验证**：所有传入令牌必须通过签名校验，防止篡改
4. **Base64URL编码**：使用URL安全的Base64编码，确保令牌在HTTP传输中兼容性

## 生产环境密钥管理
- 密钥存储：生产环境使用文件系统安全路径(/run/secrets/jwt_key)
- 权限控制：设置只读权限(0400)，仅应用进程可访问
- 开发/生产分离：开发环境使用临时密钥，生产环境强制使用安全存储

## 令牌刷新机制
- 刷新条件：令牌过期前30分钟可刷新
- 刷新流程：客户端发送refresh_token请求，服务器验证后返回新令牌
- 安全策略：旧令牌立即失效，防止重放攻击

## 安全比较函数
- 实现：使用恒定时间比较算法(secureCompare)
- 目的：防止时序攻击，确保签名验证不受响应时间差异影响